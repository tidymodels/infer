<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tidy Chi-Squared Tests with infer • infer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tidy Chi-Squared Tests with infer">
<meta name="description" content="Conducting Chi-Squared tests on tidy data with infer.">
<meta property="og:description" content="Conducting Chi-Squared tests on tidy data with infer.">
<meta property="og:image" content="https://infer.tidymodels.org/logo.png">
<meta name="robots" content="noindex">
<script defer data-domain="infer.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">infer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.7.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/infer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/t_test.html">Tidy t-Tests with infer</a></li>
    <li><a class="dropdown-item" href="../articles/anova.html">Tidy ANOVA (Analysis of Variance) with infer</a></li>
    <li><a class="dropdown-item" href="../articles/chi_squared.html">Tidy Chi-Squared Tests with infer</a></li>
    <li><a class="dropdown-item" href="../articles/paired.html">Tidy inference for paired data</a></li>
    <li><a class="dropdown-item" href="../articles/observed_stat_examples.html">Full infer Pipeline Examples</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/infer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tidy Chi-Squared Tests with infer</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/infer/blob/main/vignettes/chi_squared.Rmd" class="external-link"><code>vignettes/chi_squared.Rmd</code></a></small>
      <div class="d-none name"><code>chi_squared.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>In this vignette, we’ll walk through conducting a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
(chi-squared) test of independence and a chi-squared goodness of fit
test using infer. We’ll start out with a chi-squared test of
independence, which can be used to test the association between two
categorical variables. Then, we’ll move on to a chi-squared goodness of
fit test, which tests how well the distribution of one categorical
variable can be approximated by some theoretical distribution.</p>
<p>Throughout this vignette, we’ll make use of the <code>gss</code>
dataset supplied by infer, which contains a sample of data from the
General Social Survey. See <code><a href="../reference/gss.html">?gss</a></code> for more information on the
variables included and their source. Note that this data (and our
examples on it) are for demonstration purposes only, and will not
necessarily provide accurate estimates unless weighted properly. For
these examples, let’s suppose that this dataset is a representative
sample of a population we want to learn about: American adults. The data
looks like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">gss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 500</span></span>
<span><span class="co">## Columns: 11</span></span>
<span><span class="co">## $ year    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2014<span style="color: #949494;">, </span>1994<span style="color: #949494;">, </span>1998<span style="color: #949494;">, </span>1996<span style="color: #949494;">, </span>1994<span style="color: #949494;">, </span>1996<span style="color: #949494;">, </span>1990<span style="color: #949494;">, </span>2016<span style="color: #949494;">, </span>2000<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">## $ age     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 36<span style="color: #949494;">, </span>34<span style="color: #949494;">, </span>24<span style="color: #949494;">, </span>42<span style="color: #949494;">, </span>31<span style="color: #949494;">, </span>32<span style="color: #949494;">, </span>48<span style="color: #949494;">, </span>36<span style="color: #949494;">, </span>30<span style="color: #949494;">, </span>33<span style="color: #949494;">, </span>21<span style="color: #949494;">, </span>30<span style="color: #949494;">, </span>38<span style="color: #949494;">, </span>4…</span></span>
<span><span class="co">## $ sex     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> male<span style="color: #949494;">, </span>female<span style="color: #949494;">, </span>male<span style="color: #949494;">, </span>male<span style="color: #949494;">, </span>male<span style="color: #949494;">, </span>female<span style="color: #949494;">, </span>female<span style="color: #949494;">, </span>femal…</span></span>
<span><span class="co">## $ college <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> degree<span style="color: #949494;">, </span>no degree<span style="color: #949494;">, </span>degree<span style="color: #949494;">, </span>no degree<span style="color: #949494;">, </span>degree<span style="color: #949494;">, </span>no degr…</span></span>
<span><span class="co">## $ partyid <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> ind<span style="color: #949494;">, </span>rep<span style="color: #949494;">, </span>ind<span style="color: #949494;">, </span>ind<span style="color: #949494;">, </span>rep<span style="color: #949494;">, </span>rep<span style="color: #949494;">, </span>dem<span style="color: #949494;">, </span>ind<span style="color: #949494;">, </span>rep<span style="color: #949494;">, </span>dem<span style="color: #949494;">, </span>dem…</span></span>
<span><span class="co">## $ hompop  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>2<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">## $ hours   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 50<span style="color: #949494;">, </span>31<span style="color: #949494;">, </span>40<span style="color: #949494;">, </span>40<span style="color: #949494;">, </span>40<span style="color: #949494;">, </span>53<span style="color: #949494;">, </span>32<span style="color: #949494;">, </span>20<span style="color: #949494;">, </span>40<span style="color: #949494;">, </span>40<span style="color: #949494;">, </span>23<span style="color: #949494;">, </span>52<span style="color: #949494;">, </span>38<span style="color: #949494;">, </span>7…</span></span>
<span><span class="co">## $ income  <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> $25000 or more<span style="color: #949494;">, </span>$20000 - 24999<span style="color: #949494;">, </span>$25000 or more<span style="color: #949494;">, </span>$2500…</span></span>
<span><span class="co">## $ class   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> middle class<span style="color: #949494;">, </span>working class<span style="color: #949494;">, </span>working class<span style="color: #949494;">, </span>working c…</span></span>
<span><span class="co">## $ finrela <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> below average<span style="color: #949494;">, </span>below average<span style="color: #949494;">, </span>below average<span style="color: #949494;">, </span>above av…</span></span>
<span><span class="co">## $ weight  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8960<span style="color: #949494;">, </span>1.0825<span style="color: #949494;">, </span>0.5501<span style="color: #949494;">, </span>1.0864<span style="color: #949494;">, </span>1.0825<span style="color: #949494;">, </span>1.0864<span style="color: #949494;">, </span>1.062…</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="test-of-independence">Test of Independence<a class="anchor" aria-label="anchor" href="#test-of-independence"></a>
</h3>
<p>To carry out a chi-squared test of independence, we’ll examine the
association between income and educational attainment in the United
States. <code>college</code> is a categorical variable with values
<code>degree</code> and <code>no degree</code>, indicating whether or
not the respondent has a college degree (including community college),
and <code>finrela</code> gives the respondent’s self-identification of
family income—either <code>far below average</code>,
<code>below average</code>, <code>average</code>,
<code>above average</code>, <code>far above average</code>, or
<code>DK</code> (don’t know).</p>
<p>This is what the relationship looks like in the sample data:</p>
<p><img src="chi_squared_files/figure-html/plot-indep-1.png" width="576"></p>
<p>If there were no relationship, we would expect to see the purple bars
reaching to the same height, regardless of income class. Are the
differences we see here, though, just due to random noise?</p>
<p>First, to calculate the observed statistic, we can use
<code><a href="../reference/specify.html">specify()</a></code> and <code><a href="../reference/calculate.html">calculate()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the observed statistic</span></span>
<span><span class="va">observed_indep_statistic</span> <span class="op">&lt;-</span> <span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span><span class="va">college</span> <span class="op">~</span> <span class="va">finrela</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span></code></pre></div>
<p>The observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
statistic is 30.6825. Now, we want to compare this statistic to a null
distribution, generated under the assumption that these variables are
not actually related, to get a sense of how likely it would be for us to
see this observed statistic if there were actually no association
between education and income.</p>
<p>We can <code><a href="../reference/generate.html">generate()</a></code> the null distribution in one of two
ways—using randomization or theory-based methods. The randomization
approach approximates the null distribution by permuting the response
and explanatory variables, so that each person’s educational attainment
is matched up with a random income from the sample in order to break up
any association between the two.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate the null distribution using randomization</span></span>
<span><span class="va">null_dist_sim</span> <span class="op">&lt;-</span> <span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span><span class="va">college</span> <span class="op">~</span> <span class="va">finrela</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"permute"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span></code></pre></div>
<p>Note that, in the line <code>specify(college ~ finrela)</code> above,
we could use the equivalent syntax
<code>specify(response = college, explanatory = finrela)</code>. The
same goes in the code below, which generates the null distribution using
theory-based methods instead of randomization.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate the null distribution by theoretical approximation</span></span>
<span><span class="va">null_dist_theory</span> <span class="op">&lt;-</span> <span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span><span class="va">college</span> <span class="op">~</span> <span class="va">finrela</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/assume.html">assume</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span></code></pre></div>
<p>To get a sense for what these distributions look like, and where our
observed statistic falls, we can use <code><a href="../reference/visualize.html">visualize()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the null distribution and test statistic!</span></span>
<span><span class="va">null_dist_sim</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span><span class="va">observed_indep_statistic</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"greater"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="chi_squared_files/figure-html/visualize-indep-1.png" width="576"></p>
<p>We could also visualize the observed statistic against the
theoretical null distribution. To do so, use the <code><a href="../reference/assume.html">assume()</a></code>
verb to define a theoretical null distribution and then pass it to
<code><a href="../reference/visualize.html">visualize()</a></code> like a null distribution outputted from
<code><a href="../reference/generate.html">generate()</a></code> and <code><a href="../reference/calculate.html">calculate()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the theoretical null distribution and test statistic!</span></span>
<span><span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span><span class="va">college</span> <span class="op">~</span> <span class="va">finrela</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/assume.html">assume</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span><span class="va">observed_indep_statistic</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"greater"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="chi_squared_files/figure-html/visualize-indep-theor-1.png" width="576"></p>
<p>To visualize both the randomization-based and theoretical null
distributions to get a sense of how the two relate, we can pipe the
randomization-based null distribution into <code><a href="../reference/visualize.html">visualize()</a></code>, and
further provide <code>method = "both"</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize both null distributions and the test statistic!</span></span>
<span><span class="va">null_dist_sim</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/visualize.html">visualize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span><span class="va">observed_indep_statistic</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"greater"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="chi_squared_files/figure-html/visualize-indep-both-1.png" width="576"></p>
<p>Either way, it looks like our observed test statistic would be quite
unlikely if there were actually no association between education and
income. More exactly, we can approximate the p-value with
<code>get_p_value</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the p value from the observed statistic and null distribution</span></span>
<span><span class="va">p_value_independence</span> <span class="op">&lt;-</span> <span class="va">null_dist_sim</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/get_p_value.html">get_p_value</a></span><span class="op">(</span></span>
<span>    obs_stat <span class="op">=</span> <span class="va">observed_indep_statistic</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"greater"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p_value_independence</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">##   p_value</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>       0</span></span></code></pre>
<p>Thus, if there were really no relationship between education and
income, our approximation of the probability that we would see a
statistic as or more extreme than 30.6825 is approximately 0.</p>
<p>To calculate the p-value using the true
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
distribution, we can use the <code>pchisq</code> function from base R.
This function allows us to situate the test statistic we calculated
previously in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
distribution with the appropriate degrees of freedom.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">observed_indep_statistic</span><span class="op">$</span><span class="va">stat</span>, <span class="fl">5</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## X-squared </span></span>
<span><span class="co">## 1.082e-05</span></span></code></pre>
<p>Note that, equivalently to the theory-based approach shown above, the
package supplies a wrapper function, <code>chisq_test</code>, to carry
out Chi-Squared tests of independence on tidy data. The syntax goes like
this:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chisq_test.html">chisq_test</a></span><span class="op">(</span><span class="va">gss</span>, <span class="va">college</span> <span class="op">~</span> <span class="va">finrela</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   statistic chisq_df   p_value</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      30.7        5 0.000<span style="text-decoration: underline;">010</span>8</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="goodness-of-fit">Goodness of Fit<a class="anchor" aria-label="anchor" href="#goodness-of-fit"></a>
</h3>
<p>Now, moving on to a chi-squared goodness of fit test, we’ll take a
look at the self-identified income class of our survey respondents.
Suppose our null hypothesis is that <code>finrela</code> follows a
uniform distribution (i.e. there’s actually an equal number of people
that describe their income as far below average, below average, average,
above average, far above average, or that don’t know their income.) The
graph below represents this hypothesis:</p>
<p><img src="chi_squared_files/figure-html/gof-plot-1.png" width="576"></p>
<p>It seems like a uniform distribution may not be the most appropriate
description of the data–many more people describe their income as
average than than any of the other options. Lets now test whether this
difference in distributions is statistically significant.</p>
<p>First, to carry out this hypothesis test, we would calculate our
observed statistic.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculating the null distribution</span></span>
<span><span class="va">observed_gof_statistic</span> <span class="op">&lt;-</span> <span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">finrela</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span><span class="op">(</span></span>
<span>    null <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"far below average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"below average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"above average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"far above average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"DK"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span></code></pre></div>
<p>The observed statistic is 487.984. Now, generating a null
distribution, by just dropping in a call to <code><a href="../reference/generate.html">generate()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generating a null distribution, assuming each income class is equally likely</span></span>
<span><span class="va">null_dist_gof</span> <span class="op">&lt;-</span> <span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">finrela</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span><span class="op">(</span></span>
<span>    null <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"far below average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"below average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"above average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"far above average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>      <span class="st">"DK"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"draw"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span></code></pre></div>
<p>Again, to get a sense for what these distributions look like, and
where our observed statistic falls, we can use
<code><a href="../reference/visualize.html">visualize()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the null distribution and test statistic!</span></span>
<span><span class="va">null_dist_gof</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span><span class="va">observed_gof_statistic</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"greater"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="chi_squared_files/figure-html/visualize-indep-gof-1.png" width="576"></p>
<p>This statistic seems like it would be quite unlikely if income class
self-identification actually followed a uniform distribution! How
unlikely, though? Calculating the p-value:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the p-value</span></span>
<span><span class="va">p_value_gof</span> <span class="op">&lt;-</span> <span class="va">null_dist_gof</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/get_p_value.html">get_p_value</a></span><span class="op">(</span></span>
<span>    <span class="va">observed_gof_statistic</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"greater"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p_value_gof</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">##   p_value</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>       0</span></span></code></pre>
<p>Thus, if each self-identified income class was equally likely to
occur, our approximation of the probability that we would see a
distribution like the one we did is approximately 0.</p>
<p>To calculate the p-value using the true
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
distribution, we can use the <code>pchisq</code> function from base R.
This function allows us to situate the test statistic we calculated
previously in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
distribution with the appropriate degrees of freedom.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">observed_gof_statistic</span><span class="op">$</span><span class="va">stat</span>, <span class="fl">5</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3.131e-103</span></span></code></pre>
<p>Again, equivalently to the theory-based approach shown above, the
package supplies a wrapper function, <code><a href="../reference/chisq_test.html">chisq_test()</a></code>, to carry
out Chi-Squared goodness of fit tests on tidy data. The syntax goes like
this:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chisq_test.html">chisq_test</a></span><span class="op">(</span></span>
<span>  <span class="va">gss</span>,</span>
<span>  response <span class="op">=</span> <span class="va">finrela</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"far below average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>    <span class="st">"below average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>    <span class="st">"average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>    <span class="st">"above average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>    <span class="st">"far above average"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span>,</span>
<span>    <span class="st">"DK"</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">6</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   statistic chisq_df   p_value</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      488.        5 3.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-103</span></span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Andrew Bray, Chester Ismay, Evgeni Chasnovski, Simon Couch, Ben Baumer, Mine Cetinkaya-Rundel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
