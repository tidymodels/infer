<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tidy Chi-Squared Tests with infer • infer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Tidy Chi-Squared Tests with infer">
<meta property="og:description" content="Conducting Chi-Squared tests on tidy data with infer.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">infer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/infer.html">Getting to Know infer</a>
    </li>
    <li>
      <a href="../articles/t_test.html">t-Tests</a>
    </li>
    <li>
      <a href="../articles/anova.html">ANOVA</a>
    </li>
    <li>
      <a href="../articles/chi_squared.html">Chi-Squared</a>
    </li>
    <li>
      <a href="../articles/observed_stat_examples.html">Full infer Pipeline Examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../CONTRIBUTING.html">How To Contribute</a>
</li>
<li>
  <a href="../CONDUCT.html">Code of Conduct</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tidymodels/infer">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tidy Chi-Squared Tests with infer</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/infer/blob/master/vignettes/chi_squared.Rmd"><code>vignettes/chi_squared.Rmd</code></a></small>
      <div class="hidden name"><code>chi_squared.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level3">
<h3 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h3>
<p>In this vignette, we’ll walk through conducting a <span class="math inline">\(\chi^2\)</span> (chi-squared) test of independence and a chi-squared goodness of fit test using <code>infer</code>. We’ll start out with a chi-squared test of independence, which can be used to test the association between two categorical variables. Then, we’ll move on to a chi-squared goodness of fit test, which tests how well the distribution of one categorical variable can be approximated by some theoretical distribution.</p>
<p>Throughout this vignette, we’ll make use of the <code>gss</code> dataset supplied by <code>infer</code>, which contains a sample of data from the General Social Survey. See <code><a href="../reference/gss.html">?gss</a></code> for more information on the variables included and their source. Note that this data (and our examples on it) are for demonstration purposes only, and will not necessarily provide accurate estimates unless weighted properly. For these examples, let’s suppose that this dataset is a representative sample of a population we want to learn about: American adults. The data looks like this:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(<span class="no">gss</span>)</pre></body></html></div>
<pre><code>## Rows: 500
## Columns: 11
## $ year    &lt;dbl&gt; 2014, 1994, 1998, 1996, 1994, 1996, 1990, 2016, 2000, 1998, 2…
## $ age     &lt;dbl&gt; 36, 34, 24, 42, 31, 32, 48, 36, 30, 33, 21, 30, 38, 49, 25, 5…
## $ sex     &lt;fct&gt; male, female, male, male, male, female, female, female, femal…
## $ college &lt;fct&gt; degree, no degree, degree, no degree, degree, no degree, no d…
## $ partyid &lt;fct&gt; ind, rep, ind, ind, rep, rep, dem, ind, rep, dem, dem, ind, d…
## $ hompop  &lt;dbl&gt; 3, 4, 1, 4, 2, 4, 2, 1, 5, 2, 4, 3, 4, 4, 2, 2, 3, 2, 1, 2, 5…
## $ hours   &lt;dbl&gt; 50, 31, 40, 40, 40, 53, 32, 20, 40, 40, 23, 52, 38, 72, 48, 4…
## $ income  &lt;ord&gt; $25000 or more, $20000 - 24999, $25000 or more, $25000 or mor…
## $ class   &lt;fct&gt; middle class, working class, working class, working class, mi…
## $ finrela &lt;fct&gt; below average, below average, below average, above average, a…
## $ weight  &lt;dbl&gt; 0.8960, 1.0825, 0.5501, 1.0864, 1.0825, 1.0864, 1.0627, 0.478…</code></pre>
</div>
<div id="test-of-independence" class="section level3">
<h3 class="hasAnchor">
<a href="#test-of-independence" class="anchor"></a>Test of Independence</h3>
<p>To carry out a chi-squared test of independence, we’ll examine the association between income and educational attainment in the United States. <code>college</code> is a categorical variable with values <code>degree</code> and <code>no degree</code>, indicating whether or not the respondent has a college degree (including community college), and <code>finrela</code> gives the respondent’s self-identification of family income—either <code>far below average</code>, <code>below average</code>, <code>average</code>, <code>above average</code>, <code>far above average</code>, or <code>DK</code> (don’t know).</p>
<p>This is what the relationship looks like in the sample data:</p>
<p><img src="chi_squared_files/figure-html/plot-indep-1.png" width="576"></p>
<p>If there were no relationship, we would expect to see the purple bars reaching to the same height, regardless of income class. Are the differences we see here, though, just due to random noise?</p>
<p>First, to calculate the observed statistic, we can use <code><a href="../reference/specify.html">specify()</a></code> and <code><a href="../reference/calculate.html">calculate()</a></code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># calculate the observed statistic</span>
<span class="no">observed_indep_statistic</span> <span class="kw">&lt;-</span> <span class="no">gss</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/specify.html">specify</a></span>(<span class="no">college</span> ~ <span class="no">finrela</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/calculate.html">calculate</a></span>(<span class="kw">stat</span> <span class="kw">=</span> <span class="st">"Chisq"</span>)</pre></body></html></div>
<p>The observed <span class="math inline">\(\chi^2\)</span> statistic is 30.6825. Now, we want to compare this statistic to a null distribution, generated under the assumption that these variables are not actually related, to get a sense of how likely it would be for us to see this observed statistic if there were actually no association between education and income.</p>
<p>We can <code>generate</code> the null distribution in one of two ways—using randomization or theory-based methods. The randomization approach permutes the response and explanatory variables, so that each person’s educational attainment is matched up with a random income from the sample in order to break up any association between the two.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># generate the null distribution using randomization</span>
<span class="no">null_distribution_simulated</span> <span class="kw">&lt;-</span> <span class="no">gss</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/specify.html">specify</a></span>(<span class="no">college</span> ~ <span class="no">finrela</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span>(<span class="kw">null</span> <span class="kw">=</span> <span class="st">"independence"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/generate.html">generate</a></span>(<span class="kw">reps</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"permute"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/calculate.html">calculate</a></span>(<span class="kw">stat</span> <span class="kw">=</span> <span class="st">"Chisq"</span>)</pre></body></html></div>
<p>Note that, in the line <code><a href="../reference/specify.html">specify(college ~ finrela)</a></code> above, we could use the equivalent syntax <code><a href="../reference/specify.html">specify(response = college, explanatory = finrela)</a></code>. The same goes in the code below, which generates the null distribution using theory-based methods instead of randomization.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># generate the null distribution by theoretical approximation</span>
<span class="no">null_distribution_theoretical</span> <span class="kw">&lt;-</span> <span class="no">gss</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/specify.html">specify</a></span>(<span class="no">college</span> ~ <span class="no">finrela</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span>(<span class="kw">null</span> <span class="kw">=</span> <span class="st">"independence"</span>) <span class="kw">%&gt;%</span>
  <span class="co"># note that we skip the generation step here!</span>
  <span class="fu"><a href="../reference/calculate.html">calculate</a></span>(<span class="kw">stat</span> <span class="kw">=</span> <span class="st">"Chisq"</span>)</pre></body></html></div>
<p>To get a sense for what these distributions look like, and where our observed statistic falls, we can use <code><a href="../reference/visualize.html">visualize()</a></code>:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># visualize the null distribution and test statistic!</span>
<span class="no">null_distribution_simulated</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/visualize.html">visualize</a></span>() +
  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span>(<span class="no">observed_indep_statistic</span>,
                <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"greater"</span>)</pre></body></html></div>
<p><img src="chi_squared_files/figure-html/visualize-indep-1.png" width="576"></p>
<p>We could also visualize the observed statistic against the theoretical null distribution. Note that we skip the <code><a href="../reference/generate.html">generate()</a></code> and <code><a href="../reference/calculate.html">calculate()</a></code> steps when using the theoretical approach, and that we now need to provide <code>method = "theoretical"</code> to <code><a href="../reference/visualize.html">visualize()</a></code>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># visualize the theoretical null distribution and test statistic!</span>
<span class="no">gss</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/specify.html">specify</a></span>(<span class="no">college</span> ~ <span class="no">finrela</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span>(<span class="kw">null</span> <span class="kw">=</span> <span class="st">"independence"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/visualize.html">visualize</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"theoretical"</span>) +
  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span>(<span class="no">observed_indep_statistic</span>,
                <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"greater"</span>)</pre></body></html></div>
<p><img src="chi_squared_files/figure-html/visualize-indep-theor-1.png" width="576"></p>
<p>To visualize both the randomization-based and theoretical null distributions to get a sense of how the two relate, we can pipe the randomization-based null distribution into <code><a href="../reference/visualize.html">visualize()</a></code>, and further provide <code>method = "both"</code>.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># visualize both null distributions and the test statistic!</span>
<span class="no">null_distribution_simulated</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/visualize.html">visualize</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"both"</span>) +
  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span>(<span class="no">observed_indep_statistic</span>,
                <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"greater"</span>)</pre></body></html></div>
<p><img src="chi_squared_files/figure-html/visualize-indep-both-1.png" width="576"></p>
<p>Either way, it looks like our observed test statistic would be <em>really</em> unlikely if there were actually no association between education and income. More exactly, we can calculate the p-value:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># calculate the p value from the observed statistic and null distribution</span>
<span class="no">p_value_independence</span> <span class="kw">&lt;-</span> <span class="no">null_distribution_simulated</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_p_value.html">get_p_value</a></span>(<span class="kw">obs_stat</span> <span class="kw">=</span> <span class="no">observed_indep_statistic</span>,
              <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"greater"</span>)

<span class="no">p_value_independence</span></pre></body></html></div>
<pre><code>## # A tibble: 1 x 1
##   p_value
##     &lt;dbl&gt;
## 1       0</code></pre>
<p>Thus, if there were really no relationship between education and income, the probability that we would see a statistic as or more extreme than 30.6825 is approximately 0.</p>
<p>Note that, equivalently to the steps shown above, the package supplies a wrapper function, <code>chisq_test</code>, to carry out Chi-Squared tests of independence on tidy data. The syntax goes like this:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/chisq_test.html">chisq_test</a></span>(<span class="no">gss</span>, <span class="no">college</span> ~ <span class="no">finrela</span>)</pre></body></html></div>
<pre><code>## # A tibble: 1 x 3
##   statistic chisq_df   p_value
##       &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
## 1      30.7        5 0.0000108</code></pre>
</div>
<div id="goodness-of-fit" class="section level3">
<h3 class="hasAnchor">
<a href="#goodness-of-fit" class="anchor"></a>Goodness of Fit</h3>
<p>Now, moving on to a chi-squared goodness of fit test, we’ll take a look at the self-identified income class of our survey respondents. Suppose our null hypothesis is that <code>finrela</code> follows a uniform distribution (i.e. there’s actually an equal number of people that describe their income as far below average, below average, average, above average, far above average, or that don’t know their income.) The graph below represents this hypothesis:</p>
<p><img src="chi_squared_files/figure-html/gof-plot-1.png" width="576"></p>
<p>It seems like a uniform distribution may not be the most appropriate description of the data–many more people describe their income as average than than any of the other options. Lets now test whether this difference in distributions is statistically significant.</p>
<p>First, to carry out this hypothesis test, we would calculate our observed statistic.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># calculating the null distribution</span>
<span class="no">observed_gof_statistic</span> <span class="kw">&lt;-</span> <span class="no">gss</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/specify.html">specify</a></span>(<span class="kw">response</span> <span class="kw">=</span> <span class="no">finrela</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span>(<span class="kw">null</span> <span class="kw">=</span> <span class="st">"point"</span>,
              <span class="kw">p</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"far below average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"below average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"above average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"far above average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"DK"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/calculate.html">calculate</a></span>(<span class="kw">stat</span> <span class="kw">=</span> <span class="st">"Chisq"</span>)</pre></body></html></div>
<p>The observed statistic is 487.984. Now, generating a null distribution, by just dropping in a call to <code><a href="../reference/generate.html">generate()</a></code>:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># generating a null distribution, assuming each income class is equally likely</span>
<span class="no">null_distribution_gof</span> <span class="kw">&lt;-</span> <span class="no">gss</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/specify.html">specify</a></span>(<span class="kw">response</span> <span class="kw">=</span> <span class="no">finrela</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span>(<span class="kw">null</span> <span class="kw">=</span> <span class="st">"point"</span>,
              <span class="kw">p</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"far below average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"below average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"above average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"far above average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"DK"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/generate.html">generate</a></span>(<span class="kw">reps</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"simulate"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/calculate.html">calculate</a></span>(<span class="kw">stat</span> <span class="kw">=</span> <span class="st">"Chisq"</span>)</pre></body></html></div>
<p>Again, to get a sense for what these distributions look like, and where our observed statistic falls, we can use <code><a href="../reference/visualize.html">visualize()</a></code>:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="co"># visualize the null distribution and test statistic!</span>
<span class="no">null_distribution_gof</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/visualize.html">visualize</a></span>() +
  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span>(<span class="no">observed_gof_statistic</span>,
                <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"greater"</span>)</pre></body></html></div>
<p><img src="chi_squared_files/figure-html/visualize-indep-gof-1.png" width="576"></p>
<p>This statistic seems like it would be <em>really</em> unlikely if income class self-identification actually followed a uniform distribution! How unlikely, though? Calculating the p-value:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="co"># calculate the p-value</span>
<span class="no">p_value_gof</span> <span class="kw">&lt;-</span> <span class="no">null_distribution_gof</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_p_value.html">get_p_value</a></span>(<span class="no">observed_gof_statistic</span>,
              <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"greater"</span>)

<span class="no">p_value_gof</span></pre></body></html></div>
<pre><code>## # A tibble: 1 x 1
##   p_value
##     &lt;dbl&gt;
## 1       0</code></pre>
<p>Thus, if each self-identified income class was equally likely to occur, the probability that we would see a distribution like the one we did is approximately 0.</p>
<p>Again, equivalently to the steps shown above, the package supplies a wrapper function, <code>chisq_test</code>, to carry out Chi-Squared goodness of fit tests on tidy data. The syntax goes like this:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="../reference/chisq_test.html">chisq_test</a></span>(<span class="no">gss</span>,
           <span class="kw">response</span> <span class="kw">=</span> <span class="no">finrela</span>,
           <span class="kw">p</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"far below average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"below average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"above average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"far above average"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>,
                    <span class="st">"DK"</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">6</span>))</pre></body></html></div>
<pre><code>## # A tibble: 1 x 3
##   statistic chisq_df   p_value
##       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1      488.        5 3.13e-103</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andrew Bray, Chester Ismay, Evgeni Chasnovski, Ben Baumer, Mine Cetinkaya-Rundel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '33338960d0dcb55ff924a40c2f749a0d',
    indexName: 'infer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
